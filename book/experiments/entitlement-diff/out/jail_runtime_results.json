{
  "meta": {
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5",
    "run_id": "c7c4fdfb854b7ca0",
    "entitlement_jail": {
      "path": "book/tools/entitlement/EntitlementJail.app/Contents/MacOS/entitlement-jail",
      "sha256": "ada5d303df5779d8d1b096b298aedfc4c68be04159baab60baa8aae26b02a7b8"
    }
  },
  "env_probe": "book/experiments/entitlement-diff/out/jail_env_probe.json",
  "stage_root": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0",
  "stage_info": {
    "stage_root": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0",
    "mkdir_error": null,
    "binaries": {
      "entitlement_sample": {
        "id": "entitlement_sample",
        "src_path": "book/experiments/entitlement-diff/entitlement_sample",
        "dest_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/entitlement_sample",
        "copy_error": null,
        "chmod_error": null,
        "sha256_src": "ae302a7360b9b68ddcc1e57bf09fd2ea1086ccf5e1e56e10a0e4eaa854e90a6e",
        "sha256_dest": "ae302a7360b9b68ddcc1e57bf09fd2ea1086ccf5e1e56e10a0e4eaa854e90a6e"
      },
      "entitlement_sample_unsigned": {
        "id": "entitlement_sample_unsigned",
        "src_path": "book/experiments/entitlement-diff/entitlement_sample_unsigned",
        "dest_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/entitlement_sample_unsigned",
        "copy_error": null,
        "chmod_error": null,
        "sha256_src": "7964ed103304d457cb53aac6110c2a3e93eb09288bacdc9a4072453b926a0d64",
        "sha256_dest": "7964ed103304d457cb53aac6110c2a3e93eb09288bacdc9a4072453b926a0d64"
      },
      "mach_probe": {
        "id": "mach_probe",
        "src_path": "book/experiments/runtime-checks/mach_probe",
        "dest_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/mach_probe",
        "copy_error": null,
        "chmod_error": null,
        "sha256_src": "a8069eba4f7d9897227cff7449ee73e8b47ce89ad10883c4d82cef9ccec36165",
        "sha256_dest": "a8069eba4f7d9897227cff7449ee73e8b47ce89ad10883c4d82cef9ccec36165"
      },
      "file_probe": {
        "id": "file_probe",
        "src_path": "book/api/file_probe/file_probe",
        "dest_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/file_probe",
        "copy_error": null,
        "chmod_error": null,
        "sha256_src": "1689eec78fdaf13cb9aea4983dca55c1c1bfe4853374cb31f08d76ec25a08fb4",
        "sha256_dest": "1689eec78fdaf13cb9aea4983dca55c1c1bfe4853374cb31f08d76ec25a08fb4"
      }
    }
  },
  "container_dir": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/container",
  "container_mkdir_error": null,
  "file_probe_target": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/container/runtime.txt",
  "file_probe_target_write_error": null,
  "smoke": {
    "raw": {
      "classification": "blocked",
      "failure_kind": "JAIL_EXEC_FAILED",
      "command": [
        "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/file_probe",
        "read",
        "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/smoke.txt"
      ],
      "exit_code": 126,
      "jail_launch": {
        "command": [
          "book/tools/entitlement/EntitlementJail.app/Contents/MacOS/entitlement-jail",
          "/bin/sh",
          "-c",
          "stage=\"$1\"; out=\"$2\"; err=\"$3\"; rc=\"$4\"; done=\"$5\"; shift 5; cd \"$stage\" 2>/dev/null || exit 97; \"$@\" >\"$out\" 2>\"$err\"; printf \"%s\\n\" \"$?\" >\"$rc\"; printf \"done\\n\" >\"$done\";",
          "sh",
          "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0",
          "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/jail_out/smoke.file_probe_read.stdout",
          "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/jail_out/smoke.file_probe_read.stderr",
          "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/jail_out/smoke.file_probe_read.rc",
          "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/jail_out/smoke.file_probe_read.done",
          "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/file_probe",
          "read",
          "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/smoke.txt"
        ],
        "cwd": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0",
        "exit_code": 0,
        "stdout": "",
        "stderr": ""
      },
      "capture": {
        "attempt_id": "smoke.file_probe_read",
        "stage_root": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0",
        "stdout_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/jail_out/smoke.file_probe_read.stdout",
        "stderr_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/jail_out/smoke.file_probe_read.stderr",
        "rc_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/jail_out/smoke.file_probe_read.rc",
        "done_path": "/Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/jail_out/smoke.file_probe_read.done",
        "stdout": "",
        "stderr": "sh: /Users/achyland/Library/Containers/com.yourteam.entitlement-jail/Data/jail_stage/entitlement-diff/c7c4fdfb854b7ca0/file_probe: Operation not permitted\n",
        "rc_text": "126\n",
        "done_text": "done\n",
        "timeout_s": 15.0,
        "host_fs": {
          "stage_root": {
            "exists": true,
            "is_file": false,
            "is_dir": true,
            "mode": "0o755",
            "size": 320
          },
          "command0": {
            "exists": true,
            "is_file": true,
            "is_dir": false,
            "mode": "0o755",
            "size": 33864
          },
          "stdout_path": {
            "exists": true,
            "is_file": true,
            "is_dir": false,
            "mode": "0o644",
            "size": 0
          },
          "stderr_path": {
            "exists": true,
            "is_file": true,
            "is_dir": false,
            "mode": "0o644",
            "size": 155
          },
          "rc_path": {
            "exists": true,
            "is_file": true,
            "is_dir": false,
            "mode": "0o644",
            "size": 4
          },
          "done_path": {
            "exists": true,
            "is_file": true,
            "is_dir": false,
            "mode": "0o644",
            "size": 5
          }
        }
      }
    },
    "normalized": null,
    "smoke_write_error": null
  },
  "variants": {
    "signed": {
      "network_bind": {
        "raw": {
          "classification": "blocked",
          "failure_kind": "DEPENDENCY_EXEC_SMOKE_FAILED"
        },
        "normalized": {
          "probe_id": "network_bind",
          "classification": "blocked",
          "decision": null
        }
      },
      "network_outbound_localhost": {
        "raw": {
          "classification": "blocked",
          "failure_kind": "DEPENDENCY_EXEC_SMOKE_FAILED"
        },
        "normalized": {
          "probe_id": "network_outbound_localhost",
          "classification": "blocked",
          "decision": null
        }
      },
      "mach_lookup_cfprefsd_agent": {
        "raw": {
          "classification": "blocked",
          "failure_kind": "DEPENDENCY_EXEC_SMOKE_FAILED"
        },
        "normalized": {
          "probe_id": "mach_lookup_cfprefsd_agent",
          "classification": "blocked",
          "decision": null
        }
      },
      "file_read": {
        "raw": {
          "classification": "blocked",
          "failure_kind": "DEPENDENCY_EXEC_SMOKE_FAILED"
        },
        "normalized": {
          "probe_id": "file_read",
          "classification": "blocked",
          "decision": null
        }
      },
      "file_write": {
        "raw": {
          "classification": "blocked",
          "failure_kind": "DEPENDENCY_EXEC_SMOKE_FAILED"
        },
        "normalized": {
          "probe_id": "file_write",
          "classification": "blocked",
          "decision": null
        }
      }
    },
    "no_entitlements": {
      "network_bind": {
        "raw": {
          "classification": "blocked",
          "failure_kind": "DEPENDENCY_EXEC_SMOKE_FAILED"
        },
        "normalized": {
          "probe_id": "network_bind",
          "classification": "blocked",
          "decision": null
        }
      },
      "network_outbound_localhost": {
        "raw": {
          "classification": "blocked",
          "failure_kind": "DEPENDENCY_EXEC_SMOKE_FAILED"
        },
        "normalized": {
          "probe_id": "network_outbound_localhost",
          "classification": "blocked",
          "decision": null
        }
      },
      "mach_lookup_cfprefsd_agent": {
        "raw": {
          "classification": "blocked",
          "failure_kind": "DEPENDENCY_EXEC_SMOKE_FAILED"
        },
        "normalized": {
          "probe_id": "mach_lookup_cfprefsd_agent",
          "classification": "blocked",
          "decision": null
        }
      },
      "file_read": {
        "raw": {
          "classification": "blocked",
          "failure_kind": "DEPENDENCY_EXEC_SMOKE_FAILED"
        },
        "normalized": {
          "probe_id": "file_read",
          "classification": "blocked",
          "decision": null
        }
      },
      "file_write": {
        "raw": {
          "classification": "blocked",
          "failure_kind": "DEPENDENCY_EXEC_SMOKE_FAILED"
        },
        "normalized": {
          "probe_id": "file_write",
          "classification": "blocked",
          "decision": null
        }
      }
    }
  }
}
