[
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/mach_lookup.hardened_mach_lookup.runtime.sb",
      "--",
      "book/experiments/runtime-checks/mach_probe",
      "com.apple.cfprefsd.agent"
    ],
    "errno": -6,
    "expectation_id": "hardened:mach_lookup:deny-cfprefsd",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "mach-lookup",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/mach_lookup.hardened_mach_lookup.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "deny-cfprefsd",
    "profile_id": "hardened:mach_lookup",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:mach_lookup:deny-cfprefsd",
    "seatbelt_callouts": [
      {
        "api": "sandbox_check_by_audit_token",
        "argument": "com.apple.cfprefsd.agent",
        "check_type": 1073741829,
        "decision": "deny",
        "errno": 0,
        "filter_type": 5,
        "filter_type_name": "global-name",
        "marker_schema_version": 2,
        "no_report": true,
        "no_report_reason": null,
        "operation": "mach-lookup",
        "rc": 1,
        "stage": "preflight",
        "token_mach_kr": 0,
        "token_status": "ok",
        "tool": "seatbelt-callout",
        "varargs_count": 1
      }
    ],
    "stderr": "",
    "stdout": "",
    "target": "com.apple.cfprefsd.agent",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/mach_lookup.hardened_mach_lookup.runtime.sb",
      "--",
      "book/experiments/runtime-checks/mach_probe",
      "com.apple.sandbox-lore.hardened-runtime.bogus"
    ],
    "errno": -6,
    "expectation_id": "hardened:mach_lookup:deny-bogus",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "mach-lookup",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/mach_lookup.hardened_mach_lookup.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "deny-bogus",
    "profile_id": "hardened:mach_lookup",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:mach_lookup:deny-bogus",
    "seatbelt_callouts": [
      {
        "api": "sandbox_check_by_audit_token",
        "argument": "com.apple.sandbox-lore.hardened-runtime.bogus",
        "check_type": 1073741829,
        "decision": "deny",
        "errno": 0,
        "filter_type": 5,
        "filter_type_name": "global-name",
        "marker_schema_version": 2,
        "no_report": true,
        "no_report_reason": null,
        "operation": "mach-lookup",
        "rc": 1,
        "stage": "preflight",
        "token_mach_kr": 0,
        "token_status": "ok",
        "tool": "seatbelt-callout",
        "varargs_count": 1
      }
    ],
    "stderr": "",
    "stdout": "",
    "target": "com.apple.sandbox-lore.hardened-runtime.bogus",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/sysctl_read.hardened_sysctl_read.runtime.sb",
      "--",
      "/usr/sbin/sysctl",
      "-n",
      "kern.osrelease"
    ],
    "errno": -6,
    "expectation_id": "hardened:sysctl_read:deny-kern-osrelease",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "sysctl-read",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/sysctl_read.hardened_sysctl_read.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "deny-kern-osrelease",
    "profile_id": "hardened:sysctl_read",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:sysctl_read:deny-kern-osrelease",
    "seatbelt_callouts": [
      {
        "api": "sandbox_check_by_audit_token",
        "argument": "kern.osrelease",
        "check_type": 37,
        "decision": "error",
        "errno": 45,
        "error": "unsupported filter type (string-arg only)",
        "filter_type": 37,
        "filter_type_name": "unknown",
        "marker_schema_version": 2,
        "no_report": false,
        "no_report_reason": "unsupported_filter_type",
        "operation": "sysctl-read",
        "rc": -2,
        "stage": "preflight",
        "token_mach_kr": 0,
        "token_status": "ok",
        "tool": "seatbelt-callout",
        "varargs_count": 1
      }
    ],
    "stderr": "",
    "stdout": "",
    "target": "kern.osrelease",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/sysctl_read.hardened_sysctl_read.runtime.sb",
      "--",
      "/usr/sbin/sysctl",
      "-n",
      "kern.bootargs"
    ],
    "errno": -6,
    "expectation_id": "hardened:sysctl_read:deny-kern-bootargs",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "sysctl-read",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/sysctl_read.hardened_sysctl_read.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "deny-kern-bootargs",
    "profile_id": "hardened:sysctl_read",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:sysctl_read:deny-kern-bootargs",
    "seatbelt_callouts": [
      {
        "api": "sandbox_check_by_audit_token",
        "argument": "kern.bootargs",
        "check_type": 37,
        "decision": "error",
        "errno": 45,
        "error": "unsupported filter type (string-arg only)",
        "filter_type": 37,
        "filter_type_name": "unknown",
        "marker_schema_version": 2,
        "no_report": false,
        "no_report_reason": "unsupported_filter_type",
        "operation": "sysctl-read",
        "rc": -2,
        "stage": "preflight",
        "token_mach_kr": 0,
        "token_status": "ok",
        "tool": "seatbelt-callout",
        "varargs_count": 1
      }
    ],
    "stderr": "",
    "stdout": "",
    "target": "kern.bootargs",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/process_info_allow.hardened_process_info_allow.runtime.sb",
      "--",
      "/usr/bin/python3",
      "-c",
      "import ctypes, ctypes.util, os, sys\nlib = ctypes.CDLL(ctypes.util.find_library('proc'))\nlib.proc_pidinfo.argtypes = [ctypes.c_int, ctypes.c_int, ctypes.c_uint64, ctypes.c_void_p, ctypes.c_int]\nlib.proc_pidinfo.restype = ctypes.c_int\nPROC_PIDTBSDINFO = 3\npid_arg = sys.argv[1]\npid = os.getpid() if pid_arg == 'self' else int(pid_arg)\nbuf = ctypes.create_string_buffer(512)\nrc = lib.proc_pidinfo(pid, PROC_PIDTBSDINFO, 0, buf, ctypes.sizeof(buf))\nsys.exit(0 if rc > 0 else 1)\n",
      "self"
    ],
    "errno": -6,
    "expectation_id": "hardened:process_info_allow:pidinfo-self",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "process-info-pidinfo",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/process_info_allow.hardened_process_info_allow.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "pidinfo-self",
    "profile_id": "hardened:process_info_allow",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:process_info_allow:pidinfo-self",
    "stderr": "",
    "stdout": "",
    "target": "self",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/process_info_allow.hardened_process_info_allow.runtime.sb",
      "--",
      "/usr/bin/python3",
      "-c",
      "import ctypes, ctypes.util, os, sys\nlib = ctypes.CDLL(ctypes.util.find_library('proc'))\nlib.proc_pidinfo.argtypes = [ctypes.c_int, ctypes.c_int, ctypes.c_uint64, ctypes.c_void_p, ctypes.c_int]\nlib.proc_pidinfo.restype = ctypes.c_int\nPROC_PIDTBSDINFO = 3\npid_arg = sys.argv[1]\npid = os.getpid() if pid_arg == 'self' else int(pid_arg)\nbuf = ctypes.create_string_buffer(512)\nrc = lib.proc_pidinfo(pid, PROC_PIDTBSDINFO, 0, buf, ctypes.sizeof(buf))\nsys.exit(0 if rc > 0 else 1)\n",
      "1"
    ],
    "errno": -6,
    "expectation_id": "hardened:process_info_allow:pidinfo-init",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "process-info-pidinfo",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/process_info_allow.hardened_process_info_allow.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "pidinfo-init",
    "profile_id": "hardened:process_info_allow",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:process_info_allow:pidinfo-init",
    "stderr": "",
    "stdout": "",
    "target": "1",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/process_info_deny.hardened_process_info_deny.runtime.sb",
      "--",
      "/usr/bin/python3",
      "-c",
      "import ctypes, ctypes.util, os, sys\nlib = ctypes.CDLL(ctypes.util.find_library('proc'))\nlib.proc_pidinfo.argtypes = [ctypes.c_int, ctypes.c_int, ctypes.c_uint64, ctypes.c_void_p, ctypes.c_int]\nlib.proc_pidinfo.restype = ctypes.c_int\nPROC_PIDTBSDINFO = 3\npid_arg = sys.argv[1]\npid = os.getpid() if pid_arg == 'self' else int(pid_arg)\nbuf = ctypes.create_string_buffer(512)\nrc = lib.proc_pidinfo(pid, PROC_PIDTBSDINFO, 0, buf, ctypes.sizeof(buf))\nsys.exit(0 if rc > 0 else 1)\n",
      "self"
    ],
    "errno": -6,
    "expectation_id": "hardened:process_info_deny:pidinfo-self",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "process-info-pidinfo",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/process_info_deny.hardened_process_info_deny.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "pidinfo-self",
    "profile_id": "hardened:process_info_deny",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:process_info_deny:pidinfo-self",
    "stderr": "",
    "stdout": "",
    "target": "self",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/process_info_deny.hardened_process_info_deny.runtime.sb",
      "--",
      "/usr/bin/python3",
      "-c",
      "import ctypes, ctypes.util, os, sys\nlib = ctypes.CDLL(ctypes.util.find_library('proc'))\nlib.proc_pidinfo.argtypes = [ctypes.c_int, ctypes.c_int, ctypes.c_uint64, ctypes.c_void_p, ctypes.c_int]\nlib.proc_pidinfo.restype = ctypes.c_int\nPROC_PIDTBSDINFO = 3\npid_arg = sys.argv[1]\npid = os.getpid() if pid_arg == 'self' else int(pid_arg)\nbuf = ctypes.create_string_buffer(512)\nrc = lib.proc_pidinfo(pid, PROC_PIDTBSDINFO, 0, buf, ctypes.sizeof(buf))\nsys.exit(0 if rc > 0 else 1)\n",
      "1"
    ],
    "errno": -6,
    "expectation_id": "hardened:process_info_deny:pidinfo-init",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "process-info-pidinfo",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/process_info_deny.hardened_process_info_deny.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "pidinfo-init",
    "profile_id": "hardened:process_info_deny",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:process_info_deny:pidinfo-init",
    "stderr": "",
    "stdout": "",
    "target": "1",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/notifications.hardened_notifications.runtime.sb",
      "--",
      "/usr/bin/notifyutil",
      "-p",
      "com.sandboxlore.hardened_runtime.test1"
    ],
    "errno": -6,
    "expectation_id": "hardened:notifications:deny-allowed-darwin",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "darwin-notification-post",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/notifications.hardened_notifications.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "deny-allowed-darwin",
    "profile_id": "hardened:notifications",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:notifications:deny-allowed-darwin",
    "seatbelt_callouts": [
      {
        "api": "sandbox_check_by_audit_token",
        "argument": "com.sandboxlore.hardened_runtime.test1",
        "check_type": 34,
        "decision": "error",
        "errno": 45,
        "error": "unsupported filter type (string-arg only)",
        "filter_type": 34,
        "filter_type_name": "unknown",
        "marker_schema_version": 2,
        "no_report": false,
        "no_report_reason": "unsupported_filter_type",
        "operation": "darwin-notification-post",
        "rc": -2,
        "stage": "preflight",
        "token_mach_kr": 0,
        "token_status": "ok",
        "tool": "seatbelt-callout",
        "varargs_count": 1
      }
    ],
    "stderr": "",
    "stdout": "",
    "target": "com.sandboxlore.hardened_runtime.test1",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/notifications.hardened_notifications.runtime.sb",
      "--",
      "/usr/bin/notifyutil",
      "-p",
      "com.sandboxlore.hardened_runtime.test2"
    ],
    "errno": -6,
    "expectation_id": "hardened:notifications:deny-darwin",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "darwin-notification-post",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/notifications.hardened_notifications.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "deny-darwin",
    "profile_id": "hardened:notifications",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:notifications:deny-darwin",
    "seatbelt_callouts": [
      {
        "api": "sandbox_check_by_audit_token",
        "argument": "com.sandboxlore.hardened_runtime.test2",
        "check_type": 34,
        "decision": "error",
        "errno": 45,
        "error": "unsupported filter type (string-arg only)",
        "filter_type": 34,
        "filter_type_name": "unknown",
        "marker_schema_version": 2,
        "no_report": false,
        "no_report_reason": "unsupported_filter_type",
        "operation": "darwin-notification-post",
        "rc": -2,
        "stage": "preflight",
        "token_mach_kr": 0,
        "token_status": "ok",
        "tool": "seatbelt-callout",
        "varargs_count": 1
      }
    ],
    "stderr": "",
    "stdout": "",
    "target": "com.sandboxlore.hardened_runtime.test2",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/notifications.hardened_notifications.runtime.sb",
      "--",
      "/usr/bin/python3",
      "-c",
      "import ctypes, sys\ncf = ctypes.CDLL('/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation')\ncf.CFNotificationCenterGetDistributedCenter.restype = ctypes.c_void_p\ncenter = cf.CFNotificationCenterGetDistributedCenter()\ncf.CFStringCreateWithCString.argtypes = [ctypes.c_void_p, ctypes.c_char_p, ctypes.c_int]\ncf.CFStringCreateWithCString.restype = ctypes.c_void_p\nkCFStringEncodingUTF8 = 0x08000100\nname = sys.argv[1].encode('utf-8')\ncfname = cf.CFStringCreateWithCString(None, name, kCFStringEncodingUTF8)\ncf.CFNotificationCenterPostNotification.argtypes = [ctypes.c_void_p, ctypes.c_void_p, ctypes.c_void_p, ctypes.c_void_p, ctypes.c_bool]\ncf.CFNotificationCenterPostNotification(center, cfname, None, None, True)\n",
      "com.sandboxlore.hardened_runtime.test1"
    ],
    "errno": -6,
    "expectation_id": "hardened:notifications:deny-allowed-distributed",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "distributed-notification-post",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/notifications.hardened_notifications.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "deny-allowed-distributed",
    "profile_id": "hardened:notifications",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:notifications:deny-allowed-distributed",
    "seatbelt_callouts": [
      {
        "api": "sandbox_check_by_audit_token",
        "argument": "com.sandboxlore.hardened_runtime.test1",
        "check_type": 34,
        "decision": "error",
        "errno": 45,
        "error": "unsupported filter type (string-arg only)",
        "filter_type": 34,
        "filter_type_name": "unknown",
        "marker_schema_version": 2,
        "no_report": false,
        "no_report_reason": "unsupported_filter_type",
        "operation": "distributed-notification-post",
        "rc": -2,
        "stage": "preflight",
        "token_mach_kr": 0,
        "token_status": "ok",
        "tool": "seatbelt-callout",
        "varargs_count": 1
      }
    ],
    "stderr": "",
    "stdout": "",
    "target": "com.sandboxlore.hardened_runtime.test1",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/notifications.hardened_notifications.runtime.sb",
      "--",
      "/usr/bin/python3",
      "-c",
      "import ctypes, sys\ncf = ctypes.CDLL('/System/Library/Frameworks/CoreFoundation.framework/CoreFoundation')\ncf.CFNotificationCenterGetDistributedCenter.restype = ctypes.c_void_p\ncenter = cf.CFNotificationCenterGetDistributedCenter()\ncf.CFStringCreateWithCString.argtypes = [ctypes.c_void_p, ctypes.c_char_p, ctypes.c_int]\ncf.CFStringCreateWithCString.restype = ctypes.c_void_p\nkCFStringEncodingUTF8 = 0x08000100\nname = sys.argv[1].encode('utf-8')\ncfname = cf.CFStringCreateWithCString(None, name, kCFStringEncodingUTF8)\ncf.CFNotificationCenterPostNotification.argtypes = [ctypes.c_void_p, ctypes.c_void_p, ctypes.c_void_p, ctypes.c_void_p, ctypes.c_bool]\ncf.CFNotificationCenterPostNotification(center, cfname, None, None, True)\n",
      "com.sandboxlore.hardened_runtime.test2"
    ],
    "errno": -6,
    "expectation_id": "hardened:notifications:deny-distributed",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "distributed-notification-post",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/notifications.hardened_notifications.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "deny-distributed",
    "profile_id": "hardened:notifications",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:notifications:deny-distributed",
    "seatbelt_callouts": [
      {
        "api": "sandbox_check_by_audit_token",
        "argument": "com.sandboxlore.hardened_runtime.test2",
        "check_type": 34,
        "decision": "error",
        "errno": 45,
        "error": "unsupported filter type (string-arg only)",
        "filter_type": 34,
        "filter_type_name": "unknown",
        "marker_schema_version": 2,
        "no_report": false,
        "no_report_reason": "unsupported_filter_type",
        "operation": "distributed-notification-post",
        "rc": -2,
        "stage": "preflight",
        "token_mach_kr": 0,
        "token_status": "ok",
        "tool": "seatbelt-callout",
        "varargs_count": 1
      }
    ],
    "stderr": "",
    "stdout": "",
    "target": "com.sandboxlore.hardened_runtime.test2",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "allow",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/signal_self_allow.hardened_signal_self_allow.runtime.sb",
      "--",
      "/usr/bin/python3",
      "-c",
      "import os, subprocess, sys\nproc = subprocess.Popen(['/bin/sleep', '1'])\ntry:\n    os.kill(proc.pid, 0)\nexcept Exception:\n    proc.wait()\n    sys.exit(1)\nproc.wait()\nsys.exit(0)\n"
    ],
    "expectation_id": "hardened:signal_self_allow:signal-same-sandbox",
    "expected": "allow",
    "match": true,
    "operation": "signal",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/signal_self_allow.hardened_signal_self_allow.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "signal-same-sandbox",
    "profile_id": "hardened:signal_self_allow",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "success",
    "scenario_id": "hardened:signal_self_allow:signal-same-sandbox",
    "stderr": "",
    "stdout": "",
    "target": "same-sandbox",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  },
  {
    "actual": "deny",
    "apply_report": {
      "api": "sandbox_init",
      "err_class": "ok",
      "err_class_source": "none",
      "errbuf": null,
      "errno": 0,
      "rc": 0
    },
    "command": [
      "book/experiments/runtime-checks/sandbox_runner",
      "book/experiments/hardened-runtime/out/runtime_profiles/signal_self_deny.hardened_signal_self_deny.runtime.sb",
      "--",
      "/usr/bin/python3",
      "-c",
      "import os, subprocess, sys\nproc = subprocess.Popen(['/bin/sleep', '1'])\ntry:\n    os.kill(proc.pid, 0)\nexcept Exception:\n    proc.wait()\n    sys.exit(1)\nproc.wait()\nsys.exit(0)\n"
    ],
    "errno": 1,
    "expectation_id": "hardened:signal_self_deny:signal-same-sandbox",
    "expected": "deny",
    "failure_kind": "probe_nonzero_exit",
    "failure_stage": "probe",
    "match": true,
    "operation": "signal",
    "preflight": {
      "classification": "no_known_apply_gate_signature",
      "findings": [],
      "input_kind": "sbpl_path",
      "input_ref": "book/experiments/hardened-runtime/out/runtime_profiles/signal_self_deny.hardened_signal_self_deny.runtime.sb",
      "preflight_schema_version": 1,
      "signature": null,
      "tool": "book/tools/preflight",
      "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
    },
    "probe_name": "signal-same-sandbox",
    "profile_id": "hardened:signal_self_deny",
    "run_id": "4fd631af-2ce8-4600-99d2-10eb7984a0e4",
    "runner_info": {
      "apply_model": "exec_wrapper",
      "apply_timing": "pre_exec",
      "entrypoint": "sandbox_runner",
      "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner",
      "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e",
      "preexisting_sandbox_suspected": false,
      "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"
    },
    "runtime_status": "errno",
    "scenario_id": "hardened:signal_self_deny:signal-same-sandbox",
    "stderr": "",
    "stdout": "",
    "target": "same-sandbox",
    "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"
  }
]