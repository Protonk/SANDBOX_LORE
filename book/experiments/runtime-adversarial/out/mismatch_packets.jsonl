{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-read*", "probe_name": "read_/etc/hosts", "profile_id": "sys:airlock", "requested_path": "/etc/hosts", "runtime_status": "blocked", "scenario_id": "sys:airlock:read_/etc/hosts", "source": "book/experiments/runtime-checks/out/runtime_events.normalized.json"}, "expectation_id": "sys:airlock:read_/etc/hosts", "expected": {"anchor_binding": {"alias_used": false, "anchor": "/etc/hosts", "entry": {"field2_values": [0, 1, 4, 5, 6, 7, 3584], "filter_id": 0, "filter_name": "path", "notes": "Pinned to path for host path probes; other candidates remain possible.", "sources": ["probe:v1_file_require_any", "probe:v2_file_three_filters_any", "sys:sample"], "status": "partial"}}, "expectation_id": "sys:airlock:read_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": null, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-checks.52386", "run_id": "629a8948-b53b-4c7e-bbb4-d45dc7d01709", "run_manifest": "book/experiments/runtime-checks/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-read*", "probe_name": "read_/tmp/foo", "profile_id": "sys:airlock", "requested_path": "/tmp/foo", "runtime_status": "blocked", "scenario_id": "sys:airlock:read_/tmp/foo", "source": "book/experiments/runtime-checks/out/runtime_events.normalized.json"}, "expectation_id": "sys:airlock:read_/tmp/foo", "expected": {"anchor_binding": {"alias_used": false, "anchor": "/tmp/foo", "entry": {"field2_values": [0, 1, 2, 3, 4, 5, 6], "filter_id": 0, "filter_name": "path", "notes": "Conservatively pinned to path for file-read probes despite mixed candidates.", "sources": ["probe:v1_file_require_any", "probe:v2_file_three_filters_any"], "status": "partial"}}, "expectation_id": "sys:airlock:read_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": null, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-checks.52386", "run_id": "629a8948-b53b-4c7e-bbb4-d45dc7d01709", "run_manifest": "book/experiments/runtime-checks/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/alias/allow.txt", "observed_path": "/private/tmp/runtime-adv/alias/allow.txt", "operation": "file-read*", "probe_name": "alias-private", "profile_id": "adv:path_alias", "requested_path": "/private/tmp/runtime-adv/alias/allow.txt", "runtime_status": "errno", "scenario_id": "adv:path_alias:alias-private", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:path_alias:alias-private", "expected": {"anchor_binding": null, "expectation_id": "adv:path_alias:alias-private", "expected_decision": "allow", "target": "/private/tmp/runtime-adv/alias/allow.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/private/tmp/runtime-adv/alias/allow.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/alias/allow.txt", "observed_path": "/private/tmp/runtime-adv/alias/allow.txt", "operation": "file-read*", "probe_name": "alias-tmp", "profile_id": "adv:path_alias", "requested_path": "/tmp/runtime-adv/alias/allow.txt", "runtime_status": "errno", "scenario_id": "adv:path_alias:alias-tmp", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:path_alias:alias-tmp", "expected": {"anchor_binding": null, "expectation_id": "adv:path_alias:alias-tmp", "expected_decision": "allow", "target": "/tmp/runtime-adv/alias/allow.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/alias/allow.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"name": "baseline:adv:path_edges:allow-subpath", "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "probe_name": "allow-subpath", "profile_id": "adv:path_edges", "status": "allow", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "operation": "file-read*", "probe_name": "allow-subpath", "profile_id": "adv:path_edges", "requested_path": "/tmp/runtime-adv/edges/okdir/item.txt", "runtime_status": "errno", "scenario_id": "adv:path_edges:allow-subpath", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:path_edges:allow-subpath", "expected": {"anchor_binding": null, "expectation_id": "adv:path_edges:allow-subpath", "expected_decision": "allow", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "field2": 1, "field2_static_candidates": {"anchor_hits": [{"anchor": "/etc/hosts", "field2_values": [0, 1, 4, 5, 6, 7, 3584], "filter_id": 0, "filter_name": "path", "sources": ["probe:v1_file_require_any", "probe:v2_file_three_filters_any", "sys:sample"], "status": "partial"}, {"anchor": "/tmp/foo", "field2_values": [0, 1, 2, 3, 4, 5, 6], "filter_id": 0, "filter_name": "path", "sources": ["probe:v1_file_require_any", "probe:v2_file_three_filters_any"], "status": "partial"}, {"anchor": "/var/log", "field2_values": [0, 1, 4, 12096], "filter_id": 4, "filter_name": "ipc-posix-name", "sources": ["probe:v2_file_three_filters_any"], "status": "partial"}], "field2": 1, "filter_name": "mount-relative-path", "notes": "Nearby static-only candidate riding the same path ops/profiles as seed0; added to exercise atlas growth. No runtime probe yet.", "profiles": [{"count": 1, "name": "mount-relative-path", "profile": "sys:bsd", "tags": {"27": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "sys:sample", "tags": {"3": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "probe:airlock_system_fcntl.sb", "tags": {"0": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "probe:bsd_ops_default_file.sb", "tags": {"0": 1}}, {"count": 4, "name": "mount-relative-path", "profile": "probe:bsd_tail_context.sb", "tags": {"0": 1, "1": 2, "2": 1}}, {"count": 3, "name": "mount-relative-path", "profile": "probe:dtracehelper_posixspawn.sb", "tags": {"0": 1, "4": 2}}, {"count": 43, "name": "mount-relative-path", "profile": "probe:flow_divert_mixed.sb", "tags": {"1": 43}}, {"count": 1, "name": "mount-relative-path", "profile": "probe:flow_divert_only.sb", "tags": {"0": 1}}, {"count": 43, "name": "mount-relative-path", "profile": "probe:flow_divert_variant.sb", "tags": {"1": 43}}, {"count": 1, "name": "mount-relative-path", "profile": "probe:net_require_all_domain_proto.sb", "tags": {"0": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "probe:net_require_all_domain_type.sb", "tags": {"0": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "probe:net_require_all_domain_type_proto.sb", "tags": {"1": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "probe:net_require_all_domain_type_proto_udp.sb", "tags": {"1": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "probe:net_require_all_type_proto.sb", "tags": {"0": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "probe:right_and_preference_names.sb", "tags": {"6": 1}}, {"count": 3, "name": "mount-relative-path", "profile": "probe:v0_subpath.sb", "tags": {"0": 1, "4": 2}}, {"count": 3, "name": "mount-relative-path", "profile": "probe:v1_literal.sb", "tags": {"0": 1, "4": 2}}, {"count": 3, "name": "mount-relative-path", "profile": "probe:v2_global_name.sb", "tags": {"0": 1, "4": 2}}, {"count": 3, "name": "mount-relative-path", "profile": "probe:v3_local_name.sb", "tags": {"0": 1, "4": 2}}, {"count": 3, "name": "mount-relative-path", "profile": "probe:v4_vnode_type.sb", "tags": {"0": 1, "4": 2}}, {"count": 3, "name": "mount-relative-path", "profile": "probe:v6_iokit_registry_class.sb", "tags": {"0": 1, "4": 2}}, {"count": 3, "name": "mount-relative-path", "profile": "probe:v7_require_any_subpath_literal.sb", "tags": {"0": 1, "4": 2}}, {"count": 1, "name": "mount-relative-path", "profile": "probe-op:v1_file_require_any.sb", "tags": {"6": 1}}, {"count": 3, "name": "mount-relative-path", "profile": "probe-op:v2_file_three_filters_any.sb", "tags": {"0": 1, "4": 2}}, {"count": 1, "name": "mount-relative-path", "profile": "probe-op:v3_mach_global_local.sb", "tags": {"6": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "probe-op:v4_network_socket_require_all.sb", "tags": {"1": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "probe-op:v5_iokit_class_property.sb", "tags": {"6": 1}}, {"count": 3, "name": "mount-relative-path", "profile": "probe-op:v6_file_mach_combo.sb", "tags": {"0": 1, "4": 2}}, {"count": 1, "name": "mount-relative-path", "profile": "probe-op:v7_file_network_combo.sb", "tags": {"1": 1}}, {"count": 1, "name": "mount-relative-path", "profile": "probe-op:v8_all_combo.sb", "tags": {"0": 1}}], "seed_anchors": [{"anchor": "/etc/hosts", "source": "anchor_filter_map", "status": "partial"}], "source_artifacts": {"anchor_map": "book/graph/mappings/anchors/anchor_filter_map.json", "field2_inventory": "book/experiments/field2-filters/out/field2_inventory.json", "seeds": "book/experiments/field2-atlas/field2_seeds.json"}, "status": "ok", "tag_ids": [0, 1, 2, 3, 4, 6, 27], "target_ops": ["file-read-data", "file-write-data"], "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "mismatch_reason": "path_normalization_sensitivity", "normalization_control": {"actual": "deny", "apply_report": {"api": "sandbox_init", "err_class": "ok", "err_class_source": "none", "errbuf": null, "errno": 0, "rc": 0}, "command": ["book/experiments/runtime-checks/sandbox_runner", "book/experiments/runtime-adversarial/out/runtime_profiles/path_edges.adv_path_edges.runtime.sb", "--", "book/api/runtime_tools/native/file_probe/file_probe", "read", "/private/tmp/runtime-adv/edges/okdir/item.txt"], "errno": -6, "expectation_id": "adv:path_edges:allow-subpath-normalized", "expected": "deny", "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "match": true, "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "normalized_path_source": "observed_path", "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "observed_path_source": "unsandboxed_fd_path", "operation": "file-read*", "preflight": {"classification": "no_known_apply_gate_signature", "findings": [], "input_kind": "sbpl_path", "input_ref": "book/experiments/runtime-adversarial/out/runtime_profiles/path_edges.adv_path_edges.runtime.sb", "preflight_schema_version": 1, "signature": null, "tool": "book/tools/preflight", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "probe_name": "allow-subpath-normalized", "profile_id": "adv:path_edges", "requested_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "runner_info": {"apply_model": "exec_wrapper", "apply_timing": "pre_exec", "entrypoint": "sandbox_runner", "entrypoint_path": "book/experiments/runtime-checks/sandbox_runner", "entrypoint_sha256": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e", "preexisting_sandbox_suspected": false, "tool_build_id": "797d7d72a2807a72e87a5fb578024d66b3dd0bd61da36d756467e38d0f39063e"}, "runtime_status": "errno", "scenario_id": "adv:path_edges:allow-subpath-normalized", "seatbelt_callouts": [{"api": "sandbox_check_by_audit_token", "argument": "/private/tmp/runtime-adv/edges/okdir/item.txt", "check_type": 1073741824, "decision": "deny", "errno": 0, "filter_type": 0, "filter_type_name": "path", "marker_schema_version": 2, "no_report": true, "no_report_reason": null, "operation": "file-read*", "rc": 1, "stage": "preflight", "token_mach_kr": 0, "token_status": "ok", "tool": "seatbelt-callout", "varargs_count": 1}], "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json", "stderr": "", "stdout": "", "target": "/private/tmp/runtime-adv/edges/okdir/item.txt", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "oracle_check": {"argument": "/tmp/runtime-adv/edges/okdir/item.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/edges/a", "observed_path": "/private/tmp/runtime-adv/edges/a", "operation": "file-read*", "probe_name": "allow-tmp", "profile_id": "adv:path_edges", "requested_path": "/tmp/runtime-adv/edges/a", "runtime_status": "errno", "scenario_id": "adv:path_edges:allow-tmp", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:path_edges:allow-tmp", "expected": {"anchor_binding": null, "expectation_id": "adv:path_edges:allow-tmp", "expected_decision": "allow", "target": "/tmp/runtime-adv/edges/a"}, "field2": 0, "field2_static_candidates": {"anchor_hits": [{"anchor": "/etc/hosts", "field2_values": [0, 1, 4, 5, 6, 7, 3584], "filter_id": 0, "filter_name": "path", "sources": ["probe:v1_file_require_any", "probe:v2_file_three_filters_any", "sys:sample"], "status": "partial"}, {"anchor": "/tmp/foo", "field2_values": [0, 1, 2, 3, 4, 5, 6], "filter_id": 0, "filter_name": "path", "sources": ["probe:v1_file_require_any", "probe:v2_file_three_filters_any"], "status": "partial"}, {"anchor": "/var/log", "field2_values": [0, 1, 4, 12096], "filter_id": 4, "filter_name": "ipc-posix-name", "sources": ["probe:v2_file_three_filters_any"], "status": "partial"}, {"anchor": "IOUSBHostInterface", "field2_values": [0, 5, 6], "filter_id": null, "filter_name": null, "sources": ["probe:v5_iokit_class_property"], "status": "blocked"}, {"anchor": "com.apple.cfprefsd.agent", "field2_values": [0, 4, 5, 6], "filter_id": null, "filter_name": null, "sources": ["probe:v3_mach_global_local", "probe:v6_file_mach_combo"], "status": "blocked"}], "field2": 0, "filter_name": "path", "notes": "Multiple anchor witnesses in probe-op-structure; present in canonical sys:sample decode (tag 7). Structural coverage ok; runtime to be refreshed.", "profiles": [{"count": 9, "name": "path", "profile": "sys:airlock", "tags": {"0": 2, "166": 3, "53": 1, "58": 1, "6": 1, "71": 1}}, {"count": 3, "name": "path", "profile": "sys:bsd", "tags": {"1": 2, "26": 1}}, {"count": 1, "name": "path", "profile": "sys:sample", "tags": {"7": 1}}, {"count": 4, "name": "path", "profile": "probe:airlock_system_fcntl.sb", "tags": {"1": 3, "6": 1}}, {"count": 1, "name": "path", "profile": "probe:airlock_system_fcntl_matrix.sb", "tags": {"4": 1}}, {"count": 4, "name": "path", "profile": "probe:bsd_broader.sb", "tags": {"1": 2, "6": 1, "7": 1}}, {"count": 1, "name": "path", "profile": "probe:bsd_ops_default_file.sb", "tags": {"8": 1}}, {"count": 4, "name": "path", "profile": "probe:bsd_tail_context.sb", "tags": {"0": 1, "1": 2, "3": 1}}, {"count": 4, "name": "path", "profile": "probe:dtracehelper_posixspawn.sb", "tags": {"0": 1, "4": 2, "5": 1}}, {"count": 4, "name": "path", "profile": "probe:flow_divert_only.sb", "tags": {"0": 1, "1": 1, "2": 2}}, {"count": 4, "name": "path", "profile": "probe:net_require_all_domain_proto.sb", "tags": {"1": 2, "6": 1, "7": 1}}, {"count": 4, "name": "path", "profile": "probe:net_require_all_domain_type.sb", "tags": {"1": 2, "6": 1, "7": 1}}, {"count": 4, "name": "path", "profile": "probe:net_require_all_type_proto.sb", "tags": {"1": 2, "6": 1, "7": 1}}, {"count": 3, "name": "path", "profile": "probe:right_and_preference_names.sb", "tags": {"0": 1, "6": 2}}, {"count": 4, "name": "path", "profile": "probe:v0_subpath.sb", "tags": {"0": 1, "4": 2, "5": 1}}, {"count": 4, "name": "path", "profile": "probe:v1_literal.sb", "tags": {"0": 1, "4": 2, "5": 1}}, {"count": 4, "name": "path", "profile": "probe:v2_global_name.sb", "tags": {"0": 1, "4": 2, "5": 1}}, {"count": 4, "name": "path", "profile": "probe:v3_local_name.sb", "tags": {"0": 1, "4": 2, "5": 1}}, {"count": 1, "name": "path", "profile": "probe:v4_vnode_type.sb", "tags": {"5": 1}}, {"count": 3, "name": "path", "profile": "probe:v5_socket_domain.sb", "tags": {"0": 1, "6": 2}}, {"count": 4, "name": "path", "profile": "probe:v6_iokit_registry_class.sb", "tags": {"0": 1, "4": 2, "5": 1}}, {"count": 4, "name": "path", "profile": "probe:v7_require_any_subpath_literal.sb", "tags": {"0": 1, "4": 2, "5": 1}}, {"count": 1, "name": "path", "profile": "probe-op:v0_file_require_all.sb", "tags": {"4": 1}}, {"count": 3, "name": "path", "profile": "probe-op:v1_file_require_any.sb", "tags": {"0": 1, "6": 2}}, {"count": 4, "name": "path", "profile": "probe-op:v2_file_three_filters_any.sb", "tags": {"0": 1, "4": 2, "5": 1}}, {"count": 3, "name": "path", "profile": "probe-op:v3_mach_global_local.sb", "tags": {"0": 1, "6": 2}}, {"count": 3, "name": "path", "profile": "probe-op:v5_iokit_class_property.sb", "tags": {"0": 1, "6": 2}}, {"count": 4, "name": "path", "profile": "probe-op:v6_file_mach_combo.sb", "tags": {"0": 1, "4": 2, "5": 1}}], "seed_anchors": [{"anchor": "/etc/hosts", "source": "anchor_filter_map", "status": "partial"}, {"anchor": "/tmp/foo", "source": "anchor_filter_map", "status": "partial"}], "source_artifacts": {"anchor_map": "book/graph/mappings/anchors/anchor_filter_map.json", "field2_inventory": "book/experiments/field2-filters/out/field2_inventory.json", "seeds": "book/experiments/field2-atlas/field2_seeds.json"}, "status": "ok", "tag_ids": [0, 1, 2, 3, 4, 5, 6, 7, 8, 26, 53, 58, 71, 166], "target_ops": ["file-read-data", "file-write-data"], "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/edges/a", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt", "observed_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt", "operation": "file-read*", "probe_name": "allow-ok-deep", "profile_id": "adv:struct_flat", "requested_path": "/tmp/runtime-adv/struct/ok/deep/nested.txt", "runtime_status": "errno", "scenario_id": "adv:struct_flat:allow-ok-deep", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:struct_flat:allow-ok-deep", "expected": {"anchor_binding": null, "expectation_id": "adv:struct_flat:allow-ok-deep", "expected_decision": "allow", "target": "/tmp/runtime-adv/struct/ok/deep/nested.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt", "observed_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt", "operation": "file-read*", "probe_name": "allow-ok-root", "profile_id": "adv:struct_flat", "requested_path": "/tmp/runtime-adv/struct/ok/allowed.txt", "runtime_status": "errno", "scenario_id": "adv:struct_flat:allow-ok-root", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:struct_flat:allow-ok-root", "expected": {"anchor_binding": null, "expectation_id": "adv:struct_flat:allow-ok-root", "expected_decision": "allow", "target": "/tmp/runtime-adv/struct/ok/allowed.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/struct/ok/allowed.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt", "observed_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt", "operation": "file-read*", "probe_name": "allow-ok-deep", "profile_id": "adv:struct_nested", "requested_path": "/tmp/runtime-adv/struct/ok/deep/nested.txt", "runtime_status": "errno", "scenario_id": "adv:struct_nested:allow-ok-deep", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:struct_nested:allow-ok-deep", "expected": {"anchor_binding": null, "expectation_id": "adv:struct_nested:allow-ok-deep", "expected_decision": "allow", "target": "/tmp/runtime-adv/struct/ok/deep/nested.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt", "observed_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt", "operation": "file-read*", "probe_name": "allow-ok-root", "profile_id": "adv:struct_nested", "requested_path": "/tmp/runtime-adv/struct/ok/allowed.txt", "runtime_status": "errno", "scenario_id": "adv:struct_nested:allow-ok-root", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:struct_nested:allow-ok-root", "expected": {"anchor_binding": null, "expectation_id": "adv:struct_nested:allow-ok-root", "expected_decision": "allow", "target": "/tmp/runtime-adv/struct/ok/allowed.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/struct/ok/allowed.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "normalized_path": "/private/etc/hosts", "observed_path": "/private/etc/hosts", "operation": "file-write*", "probe_name": "write_/etc/hosts", "profile_id": "sys:airlock", "requested_path": "/etc/hosts", "runtime_status": "blocked", "scenario_id": "sys:airlock:write_/etc/hosts", "source": "book/experiments/runtime-checks/out/runtime_events.normalized.json"}, "expectation_id": "sys:airlock:write_/etc/hosts", "expected": {"anchor_binding": {"alias_used": false, "anchor": "/etc/hosts", "entry": {"field2_values": [0, 1, 4, 5, 6, 7, 3584], "filter_id": 0, "filter_name": "path", "notes": "Pinned to path for host path probes; other candidates remain possible.", "sources": ["probe:v1_file_require_any", "probe:v2_file_three_filters_any", "sys:sample"], "status": "partial"}}, "expectation_id": "sys:airlock:write_/etc/hosts", "expected_decision": "deny", "target": "/etc/hosts"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": null, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-checks.52386", "run_id": "629a8948-b53b-4c7e-bbb4-d45dc7d01709", "run_manifest": "book/experiments/runtime-checks/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": null, "errno": null, "failure_kind": "preflight_apply_gate_signature", "failure_stage": "preflight", "filter_type": null, "filter_type_name": null, "normalized_path": "/private/tmp/foo", "observed_path": "/private/tmp/foo", "operation": "file-write*", "probe_name": "write_/tmp/foo", "profile_id": "sys:airlock", "requested_path": "/tmp/foo", "runtime_status": "blocked", "scenario_id": "sys:airlock:write_/tmp/foo", "source": "book/experiments/runtime-checks/out/runtime_events.normalized.json"}, "expectation_id": "sys:airlock:write_/tmp/foo", "expected": {"anchor_binding": {"alias_used": false, "anchor": "/tmp/foo", "entry": {"field2_values": [0, 1, 2, 3, 4, 5, 6], "filter_id": 0, "filter_name": "path", "notes": "Conservatively pinned to path for file-read probes despite mixed candidates.", "sources": ["probe:v1_file_require_any", "probe:v2_file_three_filters_any"], "status": "partial"}}, "expectation_id": "sys:airlock:write_/tmp/foo", "expected_decision": "deny", "target": "/tmp/foo"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": null, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-checks.52386", "run_id": "629a8948-b53b-4c7e-bbb4-d45dc7d01709", "run_manifest": "book/experiments/runtime-checks/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "observed_path": "/private/tmp/runtime-adv/edges/okdir/item.txt", "operation": "file-write*", "probe_name": "write-subpath", "profile_id": "adv:path_edges", "requested_path": "/tmp/runtime-adv/edges/okdir/item.txt", "runtime_status": "errno", "scenario_id": "adv:path_edges:write-subpath", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:path_edges:write-subpath", "expected": {"anchor_binding": null, "expectation_id": "adv:path_edges:write-subpath", "expected_decision": "allow", "target": "/tmp/runtime-adv/edges/okdir/item.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/edges/okdir/item.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/edges/a", "observed_path": "/private/tmp/runtime-adv/edges/a", "operation": "file-write*", "probe_name": "write-tmp", "profile_id": "adv:path_edges", "requested_path": "/tmp/runtime-adv/edges/a", "runtime_status": "errno", "scenario_id": "adv:path_edges:write-tmp", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:path_edges:write-tmp", "expected": {"anchor_binding": null, "expectation_id": "adv:path_edges:write-tmp", "expected_decision": "allow", "target": "/tmp/runtime-adv/edges/a"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/edges/a", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt", "observed_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt", "operation": "file-write*", "probe_name": "write-ok-deep", "profile_id": "adv:struct_flat", "requested_path": "/tmp/runtime-adv/struct/ok/deep/nested.txt", "runtime_status": "errno", "scenario_id": "adv:struct_flat:write-ok-deep", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:struct_flat:write-ok-deep", "expected": {"anchor_binding": null, "expectation_id": "adv:struct_flat:write-ok-deep", "expected_decision": "allow", "target": "/tmp/runtime-adv/struct/ok/deep/nested.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt", "observed_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt", "operation": "file-write*", "probe_name": "write-ok-root", "profile_id": "adv:struct_flat", "requested_path": "/tmp/runtime-adv/struct/ok/allowed.txt", "runtime_status": "errno", "scenario_id": "adv:struct_flat:write-ok-root", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:struct_flat:write-ok-root", "expected": {"anchor_binding": null, "expectation_id": "adv:struct_flat:write-ok-root", "expected_decision": "allow", "target": "/tmp/runtime-adv/struct/ok/allowed.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/struct/ok/allowed.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt", "observed_path": "/private/tmp/runtime-adv/struct/ok/deep/nested.txt", "operation": "file-write*", "probe_name": "write-ok-deep", "profile_id": "adv:struct_nested", "requested_path": "/tmp/runtime-adv/struct/ok/deep/nested.txt", "runtime_status": "errno", "scenario_id": "adv:struct_nested:write-ok-deep", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:struct_nested:write-ok-deep", "expected": {"anchor_binding": null, "expectation_id": "adv:struct_nested:write-ok-deep", "expected_decision": "allow", "target": "/tmp/runtime-adv/struct/ok/deep/nested.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/struct/ok/deep/nested.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
{"baseline": {"source": "unsandboxed_fd_path", "status": "allow"}, "decision_event": {"decision": "deny", "errno": -6, "failure_kind": "probe_nonzero_exit", "failure_stage": "probe", "filter_type": 0, "filter_type_name": "path", "normalized_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt", "observed_path": "/private/tmp/runtime-adv/struct/ok/allowed.txt", "operation": "file-write*", "probe_name": "write-ok-root", "profile_id": "adv:struct_nested", "requested_path": "/tmp/runtime-adv/struct/ok/allowed.txt", "runtime_status": "errno", "scenario_id": "adv:struct_nested:write-ok-root", "source": "book/experiments/runtime-adversarial/out/runtime_events.normalized.json"}, "expectation_id": "adv:struct_nested:write-ok-root", "expected": {"anchor_binding": null, "expectation_id": "adv:struct_nested:write-ok-root", "expected_decision": "allow", "target": "/tmp/runtime-adv/struct/ok/allowed.txt"}, "field2": null, "field2_static_candidates": null, "mismatch_reason": "expectation_too_strong", "normalization_control": null, "oracle_check": {"argument": "/tmp/runtime-adv/struct/ok/allowed.txt", "decision": "deny", "filter_type": 0, "filter_type_name": "path", "stage": "preflight"}, "run_context": {"channel": "launchd_clean", "repo_root_context": "/private/tmp/sandbox-lore-launchctl/sandbox-lore.runtime-adversarial.63656", "run_id": "65312c5f-21dd-48c0-b980-c5c9487b3307", "run_manifest": "book/experiments/runtime-adversarial/out/run_manifest.json", "world_id": "sonoma-14.4.1-23E224-arm64-dyld-2c0602c5"}, "schema_version": "runtime-mismatch-packet.v0.1"}
