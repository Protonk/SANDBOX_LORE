# 2.4 PACK — What TextEdit shows us about the broader system

## A. Common patterns

- Container-centric filesystem: appsandbox-container-common/macos macros grant read/write in container, caches, and tmp; system paths (/System, /usr, /bin, /sbin) are read/exec only.
- Large mach-lookup surface to shared daemons (e.g., CoreServices, Pasteboard, CARenderServer, DiscRecording registrar, DataDetectors) typical of GUI apps needing system services.
- Read-only access to shared resources: Fonts/ColorSync profiles, Dictionaries, QuickLook, and media support paths under /Library and /System.
- Preference access pattern: broad user-preference-read domains plus specific writable prefs (TextFavorites, ServicesWithUI), matching common sandboxed app behavior.
- Keychain handling: read/write under ~/Library/Keychains/ with targeted deny for UUID path, reflecting standard per-user keychain access with guardrails.
- Temporary/trash handling: allowances for .TemporaryItems and ~/.Trash with mount-relative regexes, a recurring sandbox allowance for file management UX.
- Network stance: base network rules present but tightened with explicit denies (usbmuxd socket, CUPS localhost:631, mDNSResponder) consistent with non-network-centric apps.
- iCloud/ubiquity hooks: ubiquity-filter rules for com.apple.TextEdit enabling cloud storage within designated containers, following the common ubiquity pattern.

## B. Special cases and surprising rules

- Explicit denies inside /Library (Caches, Logs, Managed Preferences, AppStore/AppStoreContent) despite broader /Library read allows, highlighting targeted protection of system-managed data.
- Deny of file-link under ~/Library except via sandbox read-write extensions or Mobile Documents, restricting hardlink abuse while allowing extension-mediated flows.
- mDNSResponder and CUPS socket denies even without network client/server entitlements, showing defensive tightening beyond entitlement absence.
- Allowances for mach-register of third-party bundle IDs (BusyContacts, Kaleidoscope, Kindle, OneDrive) inherited from templates—unusual cross-app service registration.
- Quarantine xattr writes denied unless unquarantine entitlement present, reflecting system-wide quarantine enforcement.
- HID-private entitlement keeps IOHIDParamUserClient allowances active; atypical for a simple editor and suggests deeper input-event hooks.
- Ubiquity rules issue extensions and allow file-linking within cloud container, a narrower carve compared to generic filesystem access.
- Temporary exception scaffolding largely dropped (per comments), indicating specialization stripped unused broad exceptions.

## C. System-wide policy surfaces

- TCC/privacy services visible via mach-lookup (tccd, securityd, ocspd) show sandboxed apps still broker access through centralized privacy daemons.
- UI/graphics stack presence (windowserver, CARenderServer, frontboard/workspace, QuickLook, pasteboard) underscores reliance on shared system services for rendering and data exchange.
- App Store and managed preference paths explicitly readable while other /Library subtrees are denied, reflecting OS management of app provisioning and policy.
- Logging/diagnostics hooks (spindump, tailspind, rtcreportingd) permitted for stability reporting, hinting at system-wide telemetry allowances.
- Network policy hints: denies for usbmuxd and localhost:631 plus limited network-outbound show a general guard against unsolicited device/protocol access for sandboxed GUI apps.
- DataDetectors and dictionaries access allowed read-only, suggesting OS-level shared NLP/resources policy rather than per-app copies.
- iCloud ubiquity handling demonstrates standardized cloud storage integration via filters and extension issuance rather than arbitrary path access.

## D. Notes for the writer

- Pattern extraction tool surfaced example mach services but deeper SBPL inspection shows a much larger allowlist; emphasize breadth as a general GUI-app trait.
- Highlight the contrast between broad shared-service access (mach-lookup) and narrow filesystem writes (container-only), framing sandbox as IPC-friendly but FS-constrained.
- The denies inside /Library and socket-specific network denies are good examples of policy accretion/defense in depth—worth calling out as nuanced system constraints.
- HID private entitlement plus OneDrive/Kindle/BusyContacts mach-register allowances are curiosities; consider flagging them as legacy/template remnants.
- Tie back to Orientation/Concepts when explaining container macros, ubiquity filters, and mach-lookup semantics; Appendix can support SBPL macro descriptions.
- Future TODO: compare these patterns to another app profile to confirm which quirks are TextEdit-specific vs. true system defaults.***
