# 2.1 PACK — What TextEdit is allowed to do

## A. Observed capabilities (tool output)

- App sandbox enabled (com.apple.security.app-sandbox = true).
- User-selected files entitlements allow read/write and executable access.
- Printing entitlement present.
- Ubiquity/iCloud container enabled: ["com.apple.TextEdit"].
- Private entitlement present: com.apple.private.hid.client.event-dispatch.internal.
- Container filesystem access enabled; system paths treated read-only; downloads-specific rules absent.
- Generic network rules noted in summary despite no network entitlements.
- Mach lookups found: 14 occurrences; approx 156 service/local name tokens (global/local names and regexes) within those stanzas.

## B. SBPL-derived constraints

- Container macros grant read/write within the app container, caches, and tmp while system paths (/System, /bin, /usr*) are read/exec only; /Library mostly read-only with explicit denies for caches, logs, and managed prefs.
- File-link creation under ~/Library is denied except when using sandbox read-write extensions or Mobile Documents paths, limiting hardlinking outside sanctioned flows.
- Ubiquity-specific rules allow file-link and read/write plus extension issuance under ubiquity-filter "com.apple.TextEdit"; fileprovider-owned items can be read with xattr constraints.
- User-selected file support is wired via mach-lookup to scopedbookmarksagent and sandbox read/write extension issuance, enabling bookmark-based access beyond the container.
- Printing macro is active with supporting allowances (DiscRecording registrar, PDF Services paths) to reach the system print pipeline.
- Network is constrained: outbound/bind allowed only for resolved container paths and generic sandbox allowances, with explicit denies to /private/var/run/mDNSResponder, localhost:631 (CUPS), and usbmuxd; no network client/server entitlements.
- IPC surface is broad: mach-register for the bundle id and telemetry, plus large mach-lookup allowlist (quicklook, containermanagerd, tccd, pboxd, metadata, windowserver, pasteboard, etc.) for UI, preview, and security services.
- Keychain and preferences: read/write allowed under ~/Library/Keychains/ (except UUID-specific path denied) and numerous preference domains readable; TextFavorites/ServicesWithUI prefs are writable.
- Filesystem extras: trash and temporary item access allowed; read-only issuance for /System and home resources like Fonts/Spelling supports document rendering without granting write access.

## C. Correlated expectations

- Because app sandboxing is enabled and container macros limit writes to TextEdit’s container with system paths read-only, TextEdit’s unrestricted filesystem changes stay in its container unless mediated by extensions.
- Because com.apple.security.files.user-selected.read-write/executable are set and the profile permits scopedbookmarksagent plus sandbox extension issuance, TextEdit can open, edit, and execute user-chosen files outside its container after user approval.
- Because com.apple.developer.ubiquity-container-identifiers includes com.apple.TextEdit and SBPL grants read/write/link within that ubiquity filter, TextEdit can store and sync documents in its iCloud container.
- Because com.apple.security.print is present and the printing macro with DiscRecording/PDF Services allowances is active, TextEdit can send documents to the system print pipeline.
- Because network client/server entitlements are absent and SBPL denies mDNSResponder and localhost:631 sockets while only allowing limited outbound via container-resolving rules, TextEdit lacks broad network egress (no Bonjour/CUPS access beyond baseline sandbox networking).
- Because the private HID entitlement is present and SBPL permits IOHID-related user clients and keyboard/mouse preference reads, TextEdit can participate in HID event dispatch (text input, shortcuts) while remaining sandboxed.

## D. Notes for the writer

- Network posture is mixed: summary flags generic network rules, yet entitlements for client/server are dropped and the profile denies mDNSResponder/usbmuxd/CUPS sockets—worth calling out as “limited outbound only.”
- Downloads entitlements are absent and SBPL has no downloads-folder carveouts; external files rely on user-selected extensions/bookmarks.
- Hardlinking under ~/Library is broadly denied except via sandbox extensions or Mobile Documents, which ties into container vs. iCloud handling.
- Keychain access is relatively open for a sandboxed app (read/write under ~/Library/Keychains/ with a UUID exception); may deserve a note on credential handling expectations.
- Private HID entitlement is unusual for a simple editor; if relevant, connect to event dispatch needs (see Concepts on IPC/services).
